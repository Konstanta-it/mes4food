# Объекты выгружаемые из ERP

Для загрузки из ERP доступны следующие типы пакетов:

[![1][1]][1]

Для обмена данными в ERP нужно завести правило выгрузки, а в MES4FOOD - правило загрузки для соответствующего пакета.

## Справочники

### Физические лица

Справочник **"Физические лица"** загружается в справочник **"Физические лица"** базы MES4FOOD.

Сопоставление реквизитов объектов:

|Реквизит ERP|Реквизит MES4FOOD|
|----------|---------|
|Ссылка|Ссылка|
|ЭтоГруппа|ЭтоГруппа|
||_Отправитель = к2_инт_ВнешниеБазыОбменДаннымиИБ|
|Представление|_ОтправленныйОбъектПредставление|
|ПометкаУдаления|ПометкаУдаления|
|Родитель|Родитель|
|Наименование|Наименование|
|ФИО|ФИО|
||ФамилияИнициалы = Справочники.к2ФизическиеЛица.ФамилияИнициалыФизЛица(СправочникОбъект.ФИО)|
|КонтактнаяИнформация.Вид|КонтактнаяИнформация.Вид|
|КонтактнаяИнформация.Значение|КонтактнаяИнформация.Значение|

!!! info ""

    В видах контактной информации должен быть заполнен *ИдентификаторДляФормул*. Для заполнения можно перезаписать вид - *ИдентификаторДляФормул* заполнится автоматически.

### Структура предприятия

Справочник **"Структура предприятия"** загружается в справочник **"Подразделения"** базы MES4FOOD.

Сопоставление реквизитов объектов:

|Реквизит ERP|Реквизит MES4FOOD|
|----------|---------|
|Ссылка|Ссылка|
|ЭтоГруппа|ЭтоГруппа|
||_Отправитель = к2_инт_ВнешниеБазыОбменДаннымиИБ|
|Представление|_ОтправленныйОбъектПредставление|
|ПометкаУдаления|ПометкаУдаления|
|Родитель|Родитель|
|Наименование|Наименование|

### Склады

Справочник **"Склады"** загружается в справочник **"Склады внешних ИБ"** базы MES4FOOD.

Сопоставление реквизитов объектов:

|Реквизит ERP|Реквизит MES4FOOD|
|----------|---------|
|Ссылка|Ссылка|
|ЭтоГруппа|ЭтоГруппа|
||_Отправитель = к2_инт_ВнешниеБазыОбменДаннымиИБ|
|Представление|_ОтправленныйОбъектПредставление|
|ПометкаУдаления|ПометкаУдаления|
|Родитель|Родитель|
|Наименование|Наименование|
||ТипВнешнейИБ = ерп|

В правилах выгрузки указываются подразделения склада.

После загрузки в MES4FOOD в справочнике **"Склады внешних ИБ"** надо указать **Склады**:

[![2][2]][2]

### Контрагенты

Справочник **"Контрагенты"** загружается в справочник **"Контрагенты"** базы MES4FOOD.

Сопоставление реквизитов объектов:

|Реквизит ERP|Реквизит MES4FOOD|
|----------|---------|
|Ссылка|Ссылка|
|ЭтоГруппа|ЭтоГруппа|
||_Отправитель = к2_инт_ВнешниеБазыОбменДаннымиИБ|
|Представление|_ОтправленныйОбъектПредставление|
|ПометкаУдаления|ПометкаУдаления|
|Наименование|Наименование|
|ИНН|ИНН|
|КПП|КПП|
|КодПоОКПО|КодПоОКПО|
|ЮрФизЛицо|ЮрФизЛицо|
|Поставщик|Поставщик|
|Клиент|Покупатель|
||Тип = ЛокальнаяТочка|

### Договоры контрагентов

Справочник **"Договоры контрагентов"** загружается в справочник **"Соглашения с клиентами"** базы MES4FOOD.

Сопоставление реквизитов объектов:

|Реквизит ERP|Реквизит MES4FOOD|
|----------|---------|
|Ссылка|Ссылка|
|ЭтоГруппа|ЭтоГруппа|
||_Отправитель = к2_инт_ВнешниеБазыОбменДаннымиИБ|
|Представление|_ОтправленныйОбъектПредставление|
|ПометкаУдаления|ПометкаУдаления|
|Наименование|Наименование|
|НаименованиеДляПечати|НаименованиеДляПечати|
|Контрагент|Контрагент|
|ДатаНачалаДействия|ДатаНачалаДействия|
|ДатаОкончанияДействия|ДатаОкончанияДействия|
|ТипДоговора|ВидСоглашения|
||Налогообложение = ОблагаетсяНДС|
||Статус = Действует|
|ВалютаВзаиморасчетов|Валюта|
|ВалютаВзаиморасчетов|ВалютаВзаиморасчетов|
||ПорядокРасчетов = ПоНакладным|
||Организация = ПравилоЗагрузки.Организация|
||ВидЦен = ПравилоЗагрузки.ВидЦен|
||ГрафикОплаты = ПравилоЗагрузки.ГрафикОплаты|

В правиле выгрузки указываются типы выгружаемых договоров, статус договора = Действует.

### Номенклатура

Справочник **"Номенклатура"** загружается в справочник **"Номенклатура"** базы MES4FOOD.

Сопоставление реквизитов объектов:

|Реквизит ERP|Реквизит MES4FOOD|
|----------|---------|
|Ссылка|Ссылка|
|ЭтоГруппа|ЭтоГруппа|
||Код = УстановитьНовыйКод()|
||_Отправитель = к2_инт_ВнешниеБазыОбменДаннымиИБ|
|Представление|_ОтправленныйОбъектПредставление|
|ПометкаУдаления|ПометкаУдаления|
|Родитель|Родитель|
|Наименование|Наименование|
||ВидНоменклатуры = ПравилоЗагрузки.ВидНоменклатуры|
|НаименованиеПолное|НаименованиеПолное|
|Артикул|Артикул|
|ВесЕдиницаИзмерения|ВесЕдиницаИзмерения|
|ЕдиницаИзмерения|ЕдиницаИзмерения|
||ИспользованиеДопЕдиницИзмерения = НеИспользовать|
|ТипНоменклатуры|ТипНоменклатуры|
|СрокГодности|СрокГодности|
|ЕдиницаИзмеренияСрокаГодности|ПериодичностьСрокаГодности|
|СтавкаНДС|СтавкаНДС|
|ИспользоватьУпаковки|ИспользоватьУпаковки|
||НаборУпаковок = ИндивидуальныйДляНоменклатуры (если ИспользоватьУпаковки = Истина)|
||ТоварнаяКатегория = ПравилоЗагрузки.ТоварнаяКатегория|

В правилах выгрузки указывается вид номенклатуры.

!!! info ""

    * Поиск единиц изменения осуществляется по коду. Если не найдена - подгружается из классификатора по коду ОКЕИ
    * При загрузке, если ЕдиницаИзмерения = Штука, то она подменяется на Килограммы и создается упаковка для Штуки

### Упаковки

Справочник **"Упаковки и единицы измерения"** загружается в справочник **"Упаковки и единицы измерения"** базы MES4FOOD.

Сопоставление реквизитов объектов:

|Реквизит ERP|Реквизит MES4FOOD|
|----------|---------|
|Ссылка|Ссылка|
|ЭтоГруппа|ЭтоГруппа|
||Код = УстановитьНовыйКод()|
||_Отправитель = к2_инт_ВнешниеБазыОбменДаннымиИБ|
|Представление|_ОтправленныйОбъектПредставление|
|ПометкаУдаления|ПометкаУдаления|
|Владелец|Владелец|
|Родитель|Родитель|
|Наименование|Наименование|
|Вес|Вес|
|ВесЕдиницаИзмерения|ВесЕдиницаИзмерения|
|Числитель|Числитель|
|Знаменатель|Знаменатель|
|КоличествоУпаковок|КоличествоУпаковок|
|ЕдиницаИзмерения|ЕдиницаИзмерения|
||ТипИзмеряемойВеличины = Упаковка|
||ТипУпаковки = Конечная|

В правилах выгрузки указывается вид номенклатуры.

!!! info ""

    Поиск единиц изменения осуществляется по коду. Если не найдена - подгружается из классификатора по коду ОКЕИ

## Документы

### Перемещение товаров

Документ **"Перемещение товаров"** загружается в документ **"Распоряжение на перемещение"** базы MES4FOOD.

Сопоставление реквизитов объектов:

|Реквизит ERP|Реквизит MES4FOOD|
|----------|---------|
|Ссылка|Ссылка|
|Дата|Дата|
||Номер = УстановитьНовыйНомер()|
||_Отправитель = к2_инт_ВнешниеБазыОбменДаннымиИБ|
|Представление|_ОтправленныйОбъектПредставление|
|ПометкаУдаления|ПометкаУдаления|
|Проведен|Проведен|
||Статус = Выполнено|
|СкладОтправитель (к2СкладыВнешнихИБОбменДаннымиИБ)|СкладОтправитель = к2СкладыВнешнихИБОбменДаннымиИБ.ОсновнойСклад|
|СкладПолучатель (к2СкладыВнешнихИБОбменДаннымиИБ)|СкладПолучатель = к2СкладыВнешнихИБОбменДаннымиИБ.ОсновнойСклад|
||СпособСоздания = ОбменДанными|
||ТипПеремещения = Перемещение|
|Дата|ФактическаяДатаПеремещения|
|Товары.Номенклатура|Товары.Номенклатура|
|Товары.Серия|Товары.Серия|
|Товары.Количество|Товары.Количество|
|Серии.Номенклатура|Товары.Номенклатура|
|Серии.Количество|Товары.Количество|
|Серии.Серия|Товары.Серия|

В правиле выгрузки указывается организация и дата. Дата документа должна быть больше даты начала обмена в правиле выгрузки. Статус выгружаемых документов - Принято.

!!! info ""

    Загрузка табличной части *Товары* из табличной части *Серии* происходит следующим образом: среди уже загруженных строк ищется строка по Номенклатуре и пустой Серии. Если такая строка найдена, то она перезаполняется, если такая строка не найдена - добавляется новая

### Заказ поставщику

Документ **"Заказ поставщику"** загружается в документ **Поступление товаров и услуг** базы MES4FOOD.

Сопоставление реквизитов объектов:

|Реквизит ERP|Реквизит MES4FOOD|
|----------|---------|
|Ссылка|Ссылка|
|Дата|Дата|
||Номер = УстановитьНовыйНомер()|
||_Отправитель = к2_инт_ВнешниеБазыОбменДаннымиИБ|
|Представление|_ОтправленныйОбъектПредставление|
|ПометкаУдаления|ПометкаУдаления|
|Проведен|Проведен|
|Организация|Организация|
|Контрагент|Поставщик|
|Склад(к2СкладыВнешнихИБОбменДаннымиИБ)|Склад = к2СкладыВнешнихИБОбменДаннымиИБ.ОсновнойСклад|
|Валюта|Валюта|
|ЖелаемаяДатаПоступления|ПлановаяДатаПоставки (Если не заполнена, то Дата)|
|ДатаПоДаннымПоставщика|ДатаНакладной|
|НомерПоДаннымПоставщика|НомерНакладной|
||Статус = НеПринято|
||СпособСоздания = ОбменДанными|
||Соглашение = УсловияПродаж.Соглашение|
|Товары.Номенклатура|ТоварыПлан.Номенклатура|
|Товары.Количество|ТоварыПлан.Количество|
|Товары.Цена|ТоварыПлан.Цена|
|Товары.СтавкаНДС|ТоварыПлан.СтавкаНДС|
|Товары.Сумма|ТоварыПлан.Сумма|
|Товары.СуммаНДС|ТоварыПлан.СуммаНДС|
|Товары.СуммаСНДС|ТоварыПлан.СуммаСНДС|
|Товары.СуммаРучнойСкидки|ТоварыПлан.СуммаСкидкиНаценки|
|Товары.ПроцентРучнойСкидки|ТоварыПлан.ПроцентСкидкиНаценки|

В правиле выгрузки указывается дата, дата документа должна быть больше даты начала обмена в правиле выгрузки. Статус выгружаемых документов - Подтвержден, хозяйственная операция - закупка у поставщика.

## Регистры

### Штрихкоды номенклатуры

Данные из регистра сведений **"Штрихкоды номенклатуры"** загружаются в регистр сведений **"Штрихкоды номенклатуры"** базы MES4FOOD.

Сопоставление реквизитов объектов:

|Реквизит ERP|Реквизит MES4FOOD|
|----------|---------|
|Штрихкод|Штрихкод|
|Номенклатура|Номенклатура|
|Упаковка|Упаковка|

В правиле выгрузки указывается вид номенклатуры.

### Запрещенные для редактирования документы обмен данными ИБ

Данные из регистра сведений **"Запрещенные для редактирования документы обмен данными ИБ"** загружаются в регистр сведений **"Запрещенные для редактирования документы обмен данными ИБ"** базы MES4FOOD.

Сопоставление реквизитов объектов:

|Реквизит ERP|Реквизит MES4FOOD|
|----------|---------|
|ОбъектИБ|ОбъектИБ|
|ДатаЗапрета|ДатаЗапрета|

Для объектов, полученных из внешней ИБ.

[1]: ObjectsUnloadedFromERP.assets/1.png
[2]: ObjectsUnloadedFromERP.assets/2.png